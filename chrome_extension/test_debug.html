<!doctype html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Teste Debug - Symplifika Quick Access Icon</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                line-height: 1.6;
            }

            .test-section {
                margin-bottom: 30px;
                padding: 20px;
                border: 1px solid #ddd;
                border-radius: 8px;
                background: #f9f9f9;
            }

            .test-section h3 {
                margin-top: 0;
                color: #333;
            }

            input,
            textarea {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 16px;
            }

            textarea {
                min-height: 100px;
                resize: vertical;
            }

            .small-input {
                width: 100px;
                height: 15px;
            }

            .debug-info {
                background: #e3f2fd;
                padding: 15px;
                border-radius: 4px;
                margin: 20px 0;
                font-family: monospace;
                font-size: 14px;
            }

            .instructions {
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                padding: 15px;
                border-radius: 4px;
                margin-bottom: 20px;
            }

            button {
                background: #4f46e5;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 4px;
                cursor: pointer;
                margin: 5px;
            }

            button:hover {
                background: #3730a3;
            }

            .contenteditable {
                border: 1px solid #ccc;
                padding: 10px;
                min-height: 50px;
                background: white;
            }
        </style>
    </head>
    <body>
        <h1>üîß Teste Debug - Symplifika Quick Access Icon</h1>

        <div class="instructions">
            <h3>üìã Instru√ß√µes para Teste:</h3>
            <ol>
                <li>Abra o Console do Navegador (F12 ‚Üí Console)</li>
                <li>Passe o mouse sobre os campos de texto abaixo</li>
                <li>Verifique se aparecem mensagens de debug no console</li>
                <li>
                    Procure por mensagens que come√ßam com "üîß [DEBUG" ou "‚ùå
                    [DEBUG"
                </li>
                <li>
                    Se o √≠cone ‚ö° aparecer, clique nele para testar o tooltip
                </li>
            </ol>
        </div>

        <div class="debug-info">
            <strong>Debug Info:</strong><br />
            Extens√£o Carregada: <span id="extension-status">Verificando...</span
            ><br />
            Timestamp: <span id="timestamp"></span>
        </div>

        <div class="test-section">
            <h3>üìù Campos de Texto Padr√£o</h3>
            <input
                type="text"
                placeholder="Campo de texto simples - passe o mouse aqui"
            />
            <input
                type="email"
                placeholder="Campo de email - teste aqui tamb√©m"
            />
            <input type="search" placeholder="Campo de busca" />
            <input type="url" placeholder="Campo de URL" />
            <input type="tel" placeholder="Campo de telefone" />
            <textarea
                placeholder="√Årea de texto - o √≠cone deve aparecer aqui tamb√©m"
            ></textarea>
        </div>

        <div class="test-section">
            <h3>üéØ Campo Edit√°vel (contenteditable)</h3>
            <div class="contenteditable" contenteditable="true">
                Este √© um div edit√°vel. Clique aqui e passe o mouse para testar
                o √≠cone.
            </div>
        </div>

        <div class="test-section">
            <h3>‚ùå Campos que N√ÉO devem mostrar o √≠cone</h3>
            <input
                type="password"
                placeholder="Campo de senha - n√£o deve mostrar √≠cone"
            />
            <input
                type="text"
                class="small-input"
                placeholder="Muito pequeno"
            />
            <input
                type="text"
                style="display: none"
                placeholder="Campo oculto"
            />
            <input
                type="text"
                data-symplifika-ignore="true"
                placeholder="Campo ignorado"
            />
        </div>

        <div class="test-section">
            <h3>üîß Controles de Debug</h3>
            <button onclick="checkExtensionStatus()">
                Verificar Status da Extens√£o
            </button>
            <button onclick="clearConsole()">Limpar Console</button>
            <button onclick="showDebugInfo()">Mostrar Info Debug</button>
            <button onclick="testFieldDetection()">
                Testar Detec√ß√£o de Campos
            </button>
            <button onclick="forceTestIcon()" style="background: #dc3545">
                üîß FOR√áAR TESTE DO √çCONE
            </button>
        </div>

        <div class="test-section">
            <h3>üìä Logs de Debug</h3>
            <div
                id="debug-logs"
                style="
                    background: #f8f9fa;
                    padding: 10px;
                    font-family: monospace;
                    min-height: 100px;
                    border: 1px solid #dee2e6;
                "
            >
                Os logs aparecer√£o aqui...
            </div>
        </div>

        <script>
            // Atualizar timestamp
            document.getElementById("timestamp").textContent =
                new Date().toLocaleString();

            // Verificar se a extens√£o est√° carregada
            function checkExtensionStatus() {
                const hasQuickAccessIcon =
                    typeof QuickAccessIcon !== "undefined";
                const hasContentScript =
                    window.symphilikaContentScript || false;

                const statusElement =
                    document.getElementById("extension-status");
                if (hasQuickAccessIcon) {
                    statusElement.textContent = "‚úÖ QuickAccessIcon carregado";
                    statusElement.style.color = "green";
                } else {
                    statusElement.textContent =
                        "‚ùå QuickAccessIcon N√ÉO carregado";
                    statusElement.style.color = "red";
                }

                console.log("üîß [TEST] Status da Extens√£o:");
                console.log(
                    "üîß [TEST] - QuickAccessIcon dispon√≠vel:",
                    hasQuickAccessIcon,
                );
                console.log(
                    "üîß [TEST] - ContentScript dispon√≠vel:",
                    hasContentScript,
                );
            }

            function clearConsole() {
                console.clear();
                console.log(
                    "üîß [TEST] Console limpo - iniciando novo teste...",
                );
            }

            function showDebugInfo() {
                console.log("üîß [TEST] === INFORMA√á√ïES DE DEBUG ===");
                console.log("üîß [TEST] URL atual:", window.location.href);
                console.log("üîß [TEST] User Agent:", navigator.userAgent);
                console.log(
                    "üîß [TEST] Campos de texto encontrados:",
                    document.querySelectorAll(
                        'input[type="text"], input[type="email"], input[type="search"], input[type="url"], input[type="tel"], input[type="number"], textarea, [contenteditable="true"]',
                    ).length,
                );

                if (typeof QuickAccessIcon !== "undefined") {
                    console.log("üîß [TEST] QuickAccessIcon est√° dispon√≠vel");
                } else {
                    console.log(
                        "‚ùå [TEST] QuickAccessIcon N√ÉO est√° dispon√≠vel",
                    );
                }
            }

            function testFieldDetection() {
                console.log("üîß [TEST] === TESTE DE DETEC√á√ÉO DE CAMPOS ===");

                const selector =
                    'input[type="text"], input[type="email"], input[type="search"], input[type="url"], input[type="tel"], input[type="number"], textarea, [contenteditable="true"]';
                const fields = document.querySelectorAll(selector);

                console.log("üîß [TEST] Campos encontrados:", fields.length);

                fields.forEach((field, index) => {
                    const rect = field.getBoundingClientRect();
                    const isVisible = field.offsetParent !== null;
                    const hasIgnore = field.dataset.symplifikaIgnore === "true";
                    const isPassword = field.type === "password";
                    const sizeOk = rect.height >= 20 && rect.width >= 50;

                    console.log(`üîß [TEST] Campo ${index + 1}:`, {
                        tag: field.tagName,
                        type: field.type || "N/A",
                        visible: isVisible,
                        ignored: hasIgnore,
                        password: isPassword,
                        size: `${rect.width}x${rect.height}`,
                        sizeOk: sizeOk,
                        valid: !isPassword && !hasIgnore && isVisible && sizeOk,
                    });
                });
            }

            function forceTestIcon() {
                console.log("üîß [TEST] === TESTE FOR√áADO DO √çCONE ===");

                if (typeof QuickAccessIcon !== "undefined") {
                    // Tentar acessar a inst√¢ncia do QuickAccessIcon
                    if (
                        window.symphilikaContentScript &&
                        window.symphilikaContentScript.quickAccessIcon
                    ) {
                        console.log("üîß [TEST] Chamando teste for√ßado...");
                        window.symphilikaContentScript.quickAccessIcon.forceTestIcon();
                    } else {
                        console.log(
                            "‚ùå [TEST] Inst√¢ncia do QuickAccessIcon n√£o encontrada",
                        );
                        console.log(
                            "üîß [TEST] Tentando criar inst√¢ncia tempor√°ria...",
                        );

                        // Criar inst√¢ncia tempor√°ria para teste
                        const tempContentScript = {
                            isEnabled: true,
                            isAuthenticated: true,
                            shortcuts: [],
                        };

                        const tempQuickAccess = new QuickAccessIcon(
                            tempContentScript,
                        );
                        setTimeout(() => {
                            tempQuickAccess.forceTestIcon();
                        }, 500);
                    }
                } else {
                    console.log(
                        "‚ùå [TEST] QuickAccessIcon n√£o est√° dispon√≠vel",
                    );
                }
            }

            // Interceptar console.log para mostrar no debug
            const originalLog = console.log;
            const originalError = console.error;
            const debugLogsElement = document.getElementById("debug-logs");

            function addToDebugLogs(message, type = "log") {
                const timestamp = new Date().toLocaleTimeString();
                const color =
                    type === "error"
                        ? "red"
                        : type === "warn"
                          ? "orange"
                          : "black";
                debugLogsElement.innerHTML += `<div style="color: ${color}; margin: 2px 0;">[${timestamp}] ${message}</div>`;
                debugLogsElement.scrollTop = debugLogsElement.scrollHeight;
            }

            console.log = function (...args) {
                originalLog.apply(console, args);
                const message = args.join(" ");
                if (message.includes("[DEBUG")) {
                    addToDebugLogs(message);
                }
            };

            console.error = function (...args) {
                originalError.apply(console, args);
                const message = args.join(" ");
                if (message.includes("[DEBUG")) {
                    addToDebugLogs(message, "error");
                }
            };

            // Verificar status inicial
            setTimeout(checkExtensionStatus, 1000);
            setTimeout(showDebugInfo, 2000);

            console.log(
                "üîß [TEST] P√°gina de debug carregada - aguarde a extens√£o...",
            );
        </script>
    </body>
</html>
