{% extends 'base.html' %}
{% load static %}

{% block title %}Configurações | Symplifika{% endblock %}

{% block meta_description %}Configure suas preferências e configurações no Symplifika{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Configurações</h1>
            <p class="text-gray-600 dark:text-gray-400">
                Personalize sua experiência no Symplifika
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Settings Navigation -->
            <div class="lg:col-span-1">
                <nav class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-4">
                    <ul class="space-y-2">
                        <li>
                            <button onclick="showSection('general')"
                                    class="settings-nav-btn active w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="general">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                Geral
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('notifications')"
                                    class="settings-nav-btn w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="notifications">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM5 8a7 7 0 1114 0v6H5V8z"></path>
                                </svg>
                                Notificações
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('privacy')"
                                    class="settings-nav-btn w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="privacy">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                </svg>
                                Privacidade
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('appearance')"
                                    class="</li>settings-nav-btn w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="appearance">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"></path>
                                </svg>
                                Aparência
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('shortcuts')"
                                    class="settings-nav-btn w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="shortcuts">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Atalhos
                            </button>
                        </li>
                        <li>
                            <button onclick="showSection('account')"
                                    class="settings-nav-btn w-full text-left px-3 py-2 rounded-lg text-sm font-medium transition-colors"
                                    data-section="account">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                </svg>
                                Conta
                            </button>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Settings Content -->
            <div class="lg:col-span-3">
                <form method="post" class="space-y-8">
                    {% csrf_token %}

                    <!-- General Settings -->
                    <div id="general-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Configurações Gerais</h2>

                        <div class="space-y-6">
                            <div>
                                <label for="language" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Idioma
                                </label>
                                <select id="language" name="language"
                                        class="w-full max-w-xs px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-symplifika-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                    <option value="pt-BR">Português (Brasil)</option>
                                    <option value="en-US">English (US)</option>
                                    <option value="es-ES">Español</option>
                                </select>
                            </div>

                            <div>
                                <label for="timezone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Fuso Horário
                                </label>
                                <select id="timezone" name="timezone"
                                        class="w-full max-w-xs px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-symplifika-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                    <option value="America/Sao_Paulo">São Paulo (UTC-3)</option>
                                    <option value="America/New_York">New York (UTC-5)</option>
                                    <option value="Europe/London">London (UTC+0)</option>
                                </select>
                            </div>

                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" name="auto_save" checked
                                           class="mr-3 focus:ring-symplifika-primary">
                                    <span class="text-gray-700 dark:text-gray-300">Salvar automaticamente atalhos</span>
                                </label>
                            </div>

                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" name="enable_shortcuts" checked
                                           class="mr-3 focus:ring-symplifika-primary">
                                    <span class="text-gray-700 dark:text-gray-300">Habilitar atalhos de teclado</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Settings -->
                    <div id="notifications-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Notificações</h2>

                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Email</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="email_updates" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Atualizações do produto</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="email_security" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Alertas de segurança</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="email_marketing"
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Newsletter e promoções</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Push</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="push_shortcuts"
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Novos atalhos disponíveis</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="push_reminders"
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Lembretes de uso</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Privacy Settings -->
                    <div id="privacy-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Privacidade</h2>

                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Visibilidade do Perfil</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="radio" name="profile_visibility" value="public"
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Público - Qualquer pessoa pode ver</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="profile_visibility" value="private" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Privado - Apenas você pode ver</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Compartilhamento de Dados</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="analytics" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Permitir coleta de dados anônimos para melhorias</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="crash_reports" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Enviar relatórios de erro automaticamente</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Appearance Settings -->
                    <div id="appearance-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Aparência</h2>

                        <div class="space-y-6">
                            <div>
                                <label for="theme" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Tema
                                </label>
                                <div class="grid grid-cols-3 gap-4 mt-2">
                                    <label class="cursor-pointer">
                                        <input type="radio" name="theme" value="light" class="sr-only peer">
                                        <div class="border-2 border-gray-200 peer-checked:border-symplifika-primary rounded-lg p-4 text-center">
                                            <div class="w-8 h-8 bg-white border border-gray-300 rounded mx-auto mb-2"></div>
                                            <span class="text-sm text-gray-700 dark:text-gray-300">Claro</span>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="theme" value="dark" class="sr-only peer">
                                        <div class="border-2 border-gray-200 peer-checked:border-symplifika-primary rounded-lg p-4 text-center">
                                            <div class="w-8 h-8 bg-gray-800 rounded mx-auto mb-2"></div>
                                            <span class="text-sm text-gray-700 dark:text-gray-300">Escuro</span>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="theme" value="system" checked class="sr-only peer">
                                        <div class="border-2 border-gray-200 peer-checked:border-symplifika-primary rounded-lg p-4 text-center">
                                            <div class="w-8 h-8 bg-gradient-to-r from-white to-gray-800 rounded mx-auto mb-2"></div>
                                            <span class="text-sm text-gray-700 dark:text-gray-300">Sistema</span>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label for="font_size" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                    Tamanho da Fonte
                                </label>
                                <select id="font_size" name="font_size"
                                        class="w-full max-w-xs px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-symplifika-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                    <option value="small">Pequena</option>
                                    <option value="medium" selected>Média</option>
                                    <option value="large">Grande</option>
                                </select>
                            </div>

                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" name="reduced_motion"
                                           class="mr-3 focus:ring-symplifika-primary">
                                    <span class="text-gray-700 dark:text-gray-300">Reduzir animações</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Shortcuts Settings -->
                    <div id="shortcuts-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Atalhos</h2>

                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Configurações Padrão</h3>
                                <div class="space-y-3">
                                    <div></div>
                                        <label for="default_category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Categoria padrão
                                        </label>
                                        <select id="default_category" name="default_category"
                                                class="w-full max-w-xs px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-symplifika-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                            <option value="work">Trabalho</option>
                                            <option value="personal">Pessoal</option>
                                            <option value="productivity">Produtividade</option>
                                            <option value="entertainment">Entretenimento</option>
                                        </select>
                                    </div>

                                    <label class="flex items-center">
                                        <input type="checkbox" name="auto_organize" checked
                                               class="mr-3 focus:ring-symplifika-primary">
                                        <span class="text-gray-700 dark:text-gray-300">Organizar atalhos automaticamente</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Limites</h3>
                                <div class="space-y-3">
                                    <div>
                                        <label for="shortcuts_per_page" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Atalhos por página
                                        </label>
                                        <select id="shortcuts_per_page" name="shortcuts_per_page"
                                                class="w-full max-w-xs px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-symplifika-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                            <option value="10">10</option>
                                            <option value="25" selected>25</option>
                                            <option value="50">50</option>
                                            <option value="100">100</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Account Settings -->
                    <div id="account-section" class="settings-section bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hidden">
                        <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-6">Conta</h2>

                        <div class="space-y-6">
                            <div>
                                <h</div>3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Informações da Conta</h3>
                                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                        <div>
                                            <span class="font-medium">Email:</span>
                                            <span class="text-gray-600 dark:text-gray-400">{{ user.email }}</span>
                                        </div>
                                        <div>
                                            <span class="font-medium">Plano:</span>
                                            <span class="text-gray-600 dark:text-gray-400">
                                                {% if user.userprofile.plan %}
                                                    {{ user.userprofile.get_plan_display }}
                                                {% else %}
                                                    Gratuito
                                                {% endif %}
                                            </span>
                                        </div>
                                        <div>
                                            <span class="font-medium">Membro desde:</span>
                                            <span class="text-gray-600 dark:text-gray-400">{{ user.date_joined|date:"d/m/Y" }}</span>
                                        </div>
                                        <div>
                                            <span class="font-medium">Último acesso:</span>
                                            <span class="text-gray-600 dark:text-gray-400">{{ user.last_login|date:"d/m/Y H:i" }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Ações da Conta</h3>
                                <div class="space-y-3">
                                    <a href="{% url 'core:edit-profile' %}"
                                       class="inline-block bg-symplifika-primary text-white px-4 py-2 rounded-lg hover:bg-symplifika-accent transition-colors">
                                        Editar Perfil
                                    </a>
                                    <a href="{% url 'core:change-password' %}"
                                       class="inline-block bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-colors ml-3">
                                        Alterar Senha
                                    </a>
                                </div>
                            </div>

                            <div class="border-t border-gray-200 dark:border-gray-700 pt-6">
                                <h3 class="text-lg font-medium text-red-600 dark:text-red-400 mb-4">Zona de Perigo</h3>
                                <div class="bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4">
                                    <p class="text-red-600 dark:text-red-400 text-sm mb-4">
                                        As ações abaixo são permanentes e não podem ser desfeitas.
                                    </p>
                                    <button type="button" onclick="confirmDeleteAccount()"
                                            class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm">
                                        Excluir Conta
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <div class="flex justify-end">
                        <button type="submit"
                                class="bg-symplifika-primary text-white px-6 py-3 rounded-lg hover:bg-symplifika-accent transition-colors font-medium">
                            Salvar Configurações
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Account Modal -->
<div id="deleteAccountModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md mx-4">
        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Confirmar Exclusão da Conta</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            Esta ação é irreversível. Todos os seus dados, atalhos e configurações serão permanentemente removidos.
        </p>
        <div class="flex gap-4">
            <button onclick="deleteAccount()"
                    class="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                Sim, Excluir Conta
            </button>
            <button onclick="closeDeleteModal()"
                    class="flex-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                Cancelar
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Settings navigation
function showSection(sectionName) {
    // Hide all sections
    document.querySelectorAll('.settings-section').forEach(section => {
        section.classList.add('hidden');
    });

    // Remove active class from all nav buttons
    document.querySelectorAll('.settings-nav-btn').forEach(btn => {
        btn.classList.remove('active', 'bg-symplifika-primary', 'text-white');
        btn.classList.add('text-gray-700', 'dark:text-gray-300', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');
    });

    // Show selected section
    document.getElementById(sectionName + '-section').classList.remove('hidden');

    // Add active class to selected nav button
    const activeBtn = document.querySelector(`[data-section="${sectionName}"]`);
    activeBtn.classList.add('active', 'bg-symplifika-primary', 'text-white');
    activeBtn.classList.remove('text-gray-700', 'dark:text-gray-300', 'hover:bg-gray-100', 'dark:hover:bg-gray-700');
}

// Theme switching
document.querySelectorAll('input[name="theme"]').forEach(radio => {
    radio.addEventListener('change', function() {
        if (this.checked) {
            applyTheme(this.value);
        }
    });
});

function applyTheme(theme) {
    const html = document.documentElement;

    if (theme === 'dark') {
        html.classList.add('dark');
    } else if (theme === 'light') {
        html.classList.remove('dark');
    } else if (theme === 'system') {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            html.classList.add('dark');
        } else {
            html.classList.remove('dark');
        }
    }
}

// Font size adjustment
document.getElementById('font_size').addEventListener('change', function() {
    const fontSize = this.value;
    const html = document.documentElement;

    html.classList.remove('text-small', 'text-medium', 'text-large');
    html.classList.add('text-' + fontSize);
});

// Form submission
document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();

    // Show loading state
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.textContent = 'Salvando...';
    submitBtn.disabled = true;

    // Simulate saving
    setTimeout(() => {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;

        // Show success message
        const successDiv = document.createElement('div');
        successDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
        successDiv.textContent = 'Configurações salvas com sucesso!';
        document.body.appendChild(successDiv);

        setTimeout(() => {
            successDiv.remove();
        }, 3000);
    }, 1500);
});

// Delete account modal functions
function confirmDeleteAccount() {
    document.getElementById('deleteAccountModal').classList.remove('hidden');
}

function closeDeleteModal() {
    document.getElementById('deleteAccountModal').classList.add('hidden');
}

function deleteAccount() {
    // This would typically make an AJAX request to delete the account
    alert('Funcionalidade de exclusão de conta será implementada');
    closeDeleteModal();
}

// Auto-save functionality
let autoSaveTimeout;
function autoSave() {
    clearTimeout(autoSaveTimeout);
    autoSaveTimeout = setTimeout(() => {
        // Auto-save logic here
        console.log('Auto-saving settings...');
    }, 2000);
}

// Add change listeners for auto-save
document.querySelectorAll('input, select, textarea').forEach(element => {
    element.addEventListener('change', autoSave);
});

// Initialize theme on page load
document.addEventListener('DOMContentLoaded', function() {
    const selectedTheme = document.querySelector('input[name="theme"]:checked');
    if (selectedTheme) {
        applyTheme(selectedTheme.value);
    }
});
</script>
{% endblock %}
